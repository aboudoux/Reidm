@using Reidm.Web.Stores
@using Reidm.Application.Buildings.Queries
@inherits BlazorState.BlazorStateComponent
@inject IDialogService DialogService;


<MudPaper Width="300px" Style="Position: relative;">
    <MudNavMenu>
        @foreach (var item in State.BuildingToStudy)
        {
            <MudNavLink Href="@("/building/" + item.Key)" Icon="@Icons.Filled.OtherHouses">@item.Value</MudNavLink>
            <MudDivider/>
        }
    </MudNavMenu>

</MudPaper>
<MudFab Class="absolute top-50 right-0" Color="Color.Primary" Icon="@Icons.Material.Filled.Add" aria-label="add" Size="Size.Small" OnClick="DoubleClick"/>


@code {

    private GlobalState State => GetState<GlobalState>();

    protected override void OnAfterRender(bool firstRender)
    {
        if (firstRender)
        {
            Mediator.Send(new GlobalState.GetAllBuildingToStudy());
        }
        base.OnAfterRender(firstRender);
    }

    private void DoubleClick() {
        DialogService.Show<DialogAddBuilding>("Ajouter un immeuble à étuder",  new DialogOptions() { DisableBackdropClick = true, CloseButton = true});
    }
}